<!DOCTYPE html>
    <html>
    <head>
        <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
        <title>Challenge details.</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
        <link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        <style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', 'HelveticaNeue-Light', 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        
        <script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
    </head>
    <body>
        <hr>
<h2 id="title-%22inshack-2019--you-shall-not-pass--forensics-330-writeup%22author-%22cherief-yassine-aka-omegacoder%22date-2019-05-05t1803050200subtitle-%22data-extraction-and-port-knocking%22image-%22httpsrescloudinarycomhttps-omega-coder-github-ioimageuploadv1557078174screenshot2019-05-0518-43-57png%22bigimg-%22src%22-%22httpsrescloudinarycomhttps-omega-coder-github-ioimageuploadbrgb000000o37v1557078174screenshot2019-05-0518-43-57png%22-%22desc%22-%22port-knocking-and-data-extraction%22tags-%22inshack%22-%22writeup%22-%22ntfs%22-%22port-knocking%22-%22forensics%22categories-%22security%22-%22writeups%22-%22inshack%22-%22forensics%22">title: &quot;INShAck 2019 :: You Shall Not Pass :: Forensics 330 Writeup&quot;
author: &quot;CHERIEF Yassine Aka. omega_coder&quot;
date: 2019-05-05T18:03:05+02:00
subtitle: &quot;Data Extraction and Port knocking&quot;
image: &quot;<a href="https://res.cloudinary.com/https-omega-coder-github-io/image/upload/v1557078174/Screenshot_2019-05-05_18-43-57.png">https://res.cloudinary.com/https-omega-coder-github-io/image/upload/v1557078174/Screenshot_2019-05-05_18-43-57.png</a>&quot;
bigimg: [{&quot;src&quot;: &quot;<a href="https://res.cloudinary.com/https-omega-coder-github-io/image/upload/b_rgb:000000,o_37/v1557078174/Screenshot_2019-05-05_18-43-57.png">https://res.cloudinary.com/https-omega-coder-github-io/image/upload/b_rgb:000000,o_37/v1557078174/Screenshot_2019-05-05_18-43-57.png</a>&quot;, &quot;desc&quot;: &quot;Port knocking and Data Extraction&quot;}]
tags: [&quot;INShAck&quot;, &quot;writeup&quot;, &quot;ntfs&quot;, &quot;port-knocking&quot;, &quot;forensics&quot;]
categories: [&quot;security&quot;, &quot;writeups&quot;, &quot;INShAck&quot;, &quot;forensics&quot;]</h2>
<h1 id="challenge-details">Challenge details.</h1>
<table>
<thead>
<tr>
<th><strong>Category</strong></th>
<th><strong>Points</strong></th>
<th><strong>Solves</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Forensics</td>
<td>330</td>
<td>11</td>
</tr>
</tbody>
</table>
<h1 id="1-challenge-description">1. Challenge description</h1>
<blockquote>
<p>One of my friends is a show-off and I don't like that.<br> Help me find the backdoor he just boasted about! :D<br>You'll find an image of his USB key <a href="https://static.ctf.insecurity-insa.fr/3b89ef8bb51773c8f3478bf356271ac762ec96c3.tar.gz">here</a>.<br>And one last thing, my friend owns  <code>you-shall-not-pass.ctf.insecurity-insa.fr</code>.</p>
</blockquote>
<h1 id="2-solution">2. Solution</h1>
<h2 id="21-udata-extraction-partu">2.1 <u>Data Extraction Part</u></h2>
<p>By extracting the compressed file that was given to us, we find a raw image of an NTFS filesystem, you can verify that using the <code>file</code> command on linux. (probably made with <code>dd</code> considering the filename :D )</p>
<pre><code class="language-bash"><div>file dd.img
</div></code></pre>
<p>result of the <code>file</code> command is shown below.</p>
<p><img src="https://res.cloudinary.com/https-omega-coder-github-io/image/upload/v1557080003/Screenshot_2019-05-05_19-15-58.png" alt="file_command_output"></p>
<p>First I tried to mount the filesystem and see what we've got inside. (first you create a folder <code>/mnt/you_shall_not_pass</code>), then mount the image using the <code>mount</code> command on linux.</p>
<pre><code class="language-shell"><div>sudo mount -o loop -t ntfs dd.img /mnt/you_shall_not_pass
</div></code></pre>
<p>After mounting the filesystem, We got a bunch of weird folders &amp; files, majority of them were text files containing some <strong><code>Bacon Ipsum</code></strong> (not really important)  and one MP4 video file,  the video file contained a scene from <code>LOTR</code> (Lord Of The Ring) movie (<code>That was a good scene, where Gandalf says &quot;YOU SHALL NOT PAAASSSSS!&quot;</code>).</p>
<p>Well, let's start the work, I watched the video, read the texts with no progress at all, then i said let's check the filesystem for some <code>hidden</code> files or <code>hidden</code> strings, I first tried the <code>strings</code> command, didn't help much. Then I tried to do <code>tail</code> on the filesystem, after doing <code>tail</code> on the image, something caught my EYE :D, which looks like a <code>Base64 encoded string</code>.</p>
<p><img src="https://res.cloudinary.com/https-omega-coder-github-io/image/upload/v1557081352/Screenshot_2019-05-05_19-38-33.png" alt="base64_encoded_string"></p>
<pre><code class="language-base64"><div>H4sIAOq1yVwAA6tWUFBKyc8vUrJSMDIAAh0gvzi1sDQ1LzkVKBatAATVSgX5RSVAnqGBgSFQhVJB
UX5JPpCvFOoSoFSrg67Gkgg1RihqQpyxqSHGLjMizLEgwhxi7DIgwi4DIswxIcIcI0xzFBRiQbGT
X5CaF1+cWpyYC4ogJXdPX19XhRAPVwU3H0d3hQCfKD09PSVoNMZn5pWkFpUl5oAN1YHGNbKoaS0A
gssCMwICAAA=
</div></code></pre>
<p>It starts with <strong><code>BGZ</code></strong> and ends with <strong><code>EGZ</code></strong> !,well i guessed that right away, it's a <code>gzip compressed</code> file.</p>
<p>let's decode the base64 and see whats inside the file,</p>
<pre><code class="language-bash"><div><span class="hljs-built_in">echo</span> <span class="hljs-string">"H4sIAOq1yVwAA6tWUFBKyc8vUrJSMDIAAh0gvzi1sDQ1LzkVKBatAATVSgX5RSVAnqGBgSFQhVJB
UX5JPpCvFOoSoFSrg67Gkgg1RihqQpyxqSHGLjMizLEgwhxi7DIgwi4DIswxIcIcI0xzFBRiQbGT
X5CaF1+cWpyYC4ogJXdPX19XhRAPVwU3H0d3hQCfKD09PSVoNMZn5pWkFpUl5oAN1YHGNbKoaS0A
gssCMwICAAA="</span> | base64 -d &gt; file.gz
</div></code></pre>

    </body>
    </html>